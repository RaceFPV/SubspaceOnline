$(function() {
  var socket;
  socket = new WebSocket("ws://" + window.location.host + "/chat");
  socket.onmessage = function(event) {
    if (event.data.length) {
      if (event.data === "left") {
        player.body.velocity.x = -150;
        player.animations.play('left');
      }
      else if (event.data === "right") {
        player.body.velocity.x = 150;
        player.animations.play('right');
      }
      else if (event.data === "up") {
        if (player.body.touching.down) {
          player.body.velocity.y = -350;
        }
      }
      else {
        $("#chat").append("" + event.data + "<br>");
        document.getElementById('chat').scrollTop = 9999999;
      }
    }
  };

$("body").keydown(function(e) {
    var $input;
    var $input2;
  if(e.keyCode == 37) { // left
    //  Move to the left
    socket.send("left");
  }
  else if(e.keyCode == 39) { // right
    //  Move to the right
    socket.send("right");
  }
  else if(e.keyCode == 38) { // up
    //  Move up
    socket.send("up");
  }
});

  return $("#chatform").on("submit", function(event) {
    var $input;
    event.preventDefault();
    $input = $(this).find("#message_content");
    socket.send($input.val());
    return $input.val(null);
  });
});
